<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í‚¤ì˜¤ìŠ¤í¬ API í…ŒìŠ¤íŠ¸ (Standalone)</title>
    <style>
        body {
            font-family: 'Noto Sans KR', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .api-config {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .api-config input {
            width: 100%;
            max-width: 500px;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h2 {
            margin-top: 0;
            color: #007bff;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            border-left: 4px solid #28a745;
            background: #d4edda;
        }
        .error {
            border-left: 4px solid #dc3545;
            background: #f8d7da;
        }
        .warning {
            border-left: 4px solid #ffc107;
            background: #fff3cd;
        }
        #video {
            width: 100%;
            max-width: 640px;
            height: auto;
            border: 2px solid #ddd;
            border-radius: 5px;
            display: block;
            margin: 20px 0;
        }
        #canvas {
            display: none;
        }
        .camera-controls {
            margin: 20px 0;
        }
        select, input[type="text"] {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .ticket-list {
            margin: 20px 0;
        }
        .ticket-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.3s;
        }
        .ticket-item:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .ticket-item.selected {
            background: #007bff;
            color: white;
        }
        .ticket-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-healthy {
            background: #28a745;
        }
        .status-unhealthy {
            background: #dc3545;
        }
        .test-image-section {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .test-image-section h3 {
            margin-top: 0;
        }
        .image-preview {
            max-width: 200px;
            margin: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ í‚¤ì˜¤ìŠ¤í¬ ì–¼êµ´ ì¸ì¦ API í…ŒìŠ¤íŠ¸ (Standalone)</h1>
        
        <!-- API ì„¤ì • -->
        <div class="api-config">
            <h3>âš™ï¸ API ì„¤ì •</h3>
            <label>API Base URL:</label>
            <select id="apiMode" onchange="updateApiUrl()">
                <option value="main">ì •ì‹ API (/api/v1/kiosk)</option>
                <option value="test" selected>í…ŒìŠ¤íŠ¸ API (/api/v1/kiosk-test)</option>
            </select>
            <input type="text" id="apiUrl" value="http://localhost:8080/api/v1/kiosk-test" style="margin-top: 5px; width: 400px;" />
            
            <label>API Key:</label>
            <input type="text" id="apiKey" value="test-api-key" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
            
            <button onclick="checkAPIStatus()">ğŸ” API ìƒíƒœ í™•ì¸</button>
            
            <div id="statusResult" class="result" style="margin-top: 10px;"></div>
        </div>
        
        <!-- ì¹´ë©”ë¼ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
        <div class="test-section">
            <h2>ğŸ“· 1. ì–¼êµ´ ì¸ì¦ í…ŒìŠ¤íŠ¸</h2>
            
            <div>
                <label>ì–¸ì–´ ì„ íƒ:</label>
                <select id="language">
                    <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                </select>
                
                <label>ì¥ì¹˜ ID:</label>
                <input type="text" id="deviceId" value="KIOSK_TEST_001" />
                
                <label>ìœ„ì¹˜:</label>
                <input type="text" id="location" value="TEST_LOCATION" />
            </div>
            
            <div class="camera-controls">
                <button onclick="startCamera()">â–¶ï¸ ì¹´ë©”ë¼ ì‹œì‘</button>
                <button onclick="captureAndAuth()" id="captureBtn" disabled>ğŸ“¸ ì–¼êµ´ ì´¬ì˜ ë° ì¸ì¦</button>
                <button onclick="stopCamera()">â¹ï¸ ì¹´ë©”ë¼ ì¤‘ì§€</button>
            </div>
            
            <video id="video" autoplay></video>
            <canvas id="canvas"></canvas>
            
            <div id="authResult" class="result"></div>
        </div>
        
        <!-- ì²´í¬ì¸ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
        <div class="test-section">
            <h2>âœ… 2. ì²´í¬ì¸ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸</h2>
            
            <div id="memberInfo" style="display:none; margin: 20px 0; padding: 15px; background: #e3f2fd; border-radius: 5px;">
                <h3>íšŒì› ì •ë³´</h3>
                <div id="memberDetails"></div>
            </div>
            
            <div id="ticketList" class="ticket-list"></div>
            
            <button onclick="processCheckin()" disabled id="checkinBtn">âœ… ì„ íƒí•œ ì´ìš©ê¶Œìœ¼ë¡œ ì²´í¬ì¸</button>
            
            <div id="checkinResult" class="result"></div>
        </div>
        
        <!-- ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ§ª 3. ì‹œë‚˜ë¦¬ì˜¤ë³„ í…ŒìŠ¤íŠ¸</h2>
            
            <button onclick="testNoFace()">ğŸ˜¶ ì–¼êµ´ ë¯¸ê²€ì¶œ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button onclick="testSecurityFail()">ğŸš« ë³´ì•ˆ ê²€ì¦ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button onclick="testMemberNotFound()">â“ íšŒì› ë¯¸ë°œê²¬ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button onclick="testNoTickets()">ğŸ« ì´ìš©ê¶Œ ì—†ìŒ ì‹œë‚˜ë¦¬ì˜¤</button>
            
            <div id="scenarioResult" class="result"></div>
        </div>
        
        <!-- í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ì„¹ì…˜ -->
        <div class="test-section">
            <h2>ğŸ–¼ï¸ 4. í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ</h2>
            
            <div class="test-image-section">
                <h3>ì´ë¯¸ì§€ íŒŒì¼ë¡œ í…ŒìŠ¤íŠ¸</h3>
                <input type="file" id="imageFile" accept="image/*" onchange="handleImageUpload(event)" />
                <img id="imagePreview" class="image-preview" style="display:none;" />
                <button onclick="testWithUploadedImage()" disabled id="testImageBtn">ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ë¡œ í…ŒìŠ¤íŠ¸</button>
            </div>
        </div>
    </div>
    
    <script>
        let stream = null;
        let selectedMember = null;
        let selectedTicket = null;
        let uploadedImageBase64 = null;
        
        // API URL ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateApiUrl() {
            const mode = document.getElementById('apiMode').value;
            const apiUrlInput = document.getElementById('apiUrl');
            
            if (mode === 'main') {
                apiUrlInput.value = 'http://localhost:8080/api/v1/kiosk';
                console.log('API ëª¨ë“œ ë³€ê²½: ì •ì‹ API');
            } else {
                apiUrlInput.value = 'http://localhost:8080/api/v1/kiosk-test';
                console.log('API ëª¨ë“œ ë³€ê²½: í…ŒìŠ¤íŠ¸ API');
            }
            
            // ìƒíƒœ ì´ˆê¸°í™”
            document.getElementById('statusResult').innerHTML = '';
            console.log('í˜„ì¬ API URL:', apiUrlInput.value);
        }
        
        // API ìƒíƒœ í™•ì¸
        function checkAPIStatus() {
            const apiUrl = document.getElementById('apiUrl').value;
            const apiKey = document.getElementById('apiKey').value;
            
            console.log('API ìƒíƒœ í™•ì¸ ìš”ì²­:', apiUrl + '/status');
            console.log('ì‚¬ìš©í•˜ëŠ” API í‚¤:', apiKey);
            
            showResult('statusResult', 'ìƒíƒœ í™•ì¸ ì¤‘...', 'warning');
            
            fetch(apiUrl + '/status', {
                method: 'GET',
                headers: {
                    'X-API-Key': apiKey
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('API Status:', data);
                if (data.success) {
                    let statusHtml = `âœ… API ìƒíƒœ: ${data.status}\n\nêµ¬ì„± ìš”ì†Œ ìƒíƒœ:\n`;
                    for (const [component, status] of Object.entries(data.components)) {
                        const emoji = status === 'healthy' ? 'âœ…' : 'âŒ';
                        statusHtml += `${emoji} ${component}: ${status}\n`;
                    }
                    statusHtml += `\nâ° í™•ì¸ ì‹œê°„: ${data.timestamp}`;
                    showResult('statusResult', statusHtml, 'success');
                } else {
                    showResult('statusResult', 'âŒ API ìƒíƒœ í™•ì¸ ì‹¤íŒ¨\n' + JSON.stringify(data, null, 2), 'error');
                }
            })
            .catch(error => {
                showResult('statusResult', 
                    `âŒ API ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤\n\n` +
                    `URL: ${apiUrl}\n` +
                    `ì˜¤ë¥˜: ${error.message}\n\n` +
                    `í™•ì¸ì‚¬í•­:\n` +
                    `1. API ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”\n` +
                    `2. URLì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•˜ì„¸ìš”\n` +
                    `3. CORS ì„¤ì •ì´ ë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”`, 
                    'error'
                );
            });
        }
        
        // ì¹´ë©”ë¼ ì‹œì‘
        function startCamera() {
            const video = document.getElementById('video');
            
            navigator.mediaDevices.getUserMedia({ 
                video: { 
                    width: { ideal: 640 },
                    height: { ideal: 480 }
                } 
            })
            .then(function(s) {
                stream = s;
                video.srcObject = stream;
                document.getElementById('captureBtn').disabled = false;
                showResult('authResult', 'âœ… ì¹´ë©”ë¼ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            })
            .catch(function(err) {
                showResult('authResult', 'âŒ ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨: ' + err.message, 'error');
            });
        }
        
        // ì¹´ë©”ë¼ ì¤‘ì§€
        function stopCamera() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
                document.getElementById('video').srcObject = null;
                document.getElementById('captureBtn').disabled = true;
                showResult('authResult', 'â¹ï¸ ì¹´ë©”ë¼ê°€ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            }
        }
        
        // ì–¼êµ´ ì´¬ì˜ ë° ì¸ì¦
        function captureAndAuth() {
            const video = document.getElementById('video');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            
            // Base64ë¡œ ë³€í™˜
            const imageData = canvas.toDataURL('image/jpeg', 0.8).split(',')[1];
            
            performFaceAuth(imageData);
        }
        
        // ì–¼êµ´ ì¸ì¦ ìˆ˜í–‰
        function performFaceAuth(imageBase64) {
            const apiUrl = document.getElementById('apiUrl').value;
            const apiKey = document.getElementById('apiKey').value;
            
            // API í˜¸ì¶œ
            const requestData = {
                image: imageBase64,
                device_id: document.getElementById('deviceId').value,
                location: document.getElementById('location').value,
                check_liveness: true,
                language: document.getElementById('language').value
            };
            
            showResult('authResult', 'ğŸ”„ ì¸ì¦ ìš”ì²­ ì¤‘...', 'warning');
            
            fetch(apiUrl + '/face-auth', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-API-Key': apiKey
                },
                body: JSON.stringify(requestData)
            })
            .then(response => response.json())
            .then(data => {
                console.log('Response:', data);
                
                if (data.success) {
                    showResult('authResult', 
                        `âœ… ì¸ì¦ ì„±ê³µ!\n\n` +
                        JSON.stringify(data, null, 2), 
                        'success'
                    );
                    
                    // íšŒì› ì •ë³´ í‘œì‹œ
                    if (data.data && data.data.member) {
                        selectedMember = data.data.member;
                        displayMemberInfo(data.data.member);
                    }
                    
                    // ì´ìš©ê¶Œì´ ìˆìœ¼ë©´ í‘œì‹œ
                    if (data.data && data.data.tickets && data.data.tickets.length > 0) {
                        displayTickets(data.data.tickets);
                    } else if (data.error_code === 'E006') {
                        document.getElementById('ticketList').innerHTML = 
                            '<div class="warning" style="padding: 20px;">âš ï¸ ì‚¬ìš© ê°€ëŠ¥í•œ ì´ìš©ê¶Œì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                    }
                } else {
                    const errorEmoji = getErrorEmoji(data.error_code);
                    showResult('authResult', 
                        `${errorEmoji} ì¸ì¦ ì‹¤íŒ¨\n\n` +
                        JSON.stringify(data, null, 2), 
                        'error'
                    );
                }
            })
            .catch(error => {
                showResult('authResult', 
                    `âŒ API í˜¸ì¶œ ì‹¤íŒ¨\n\n` +
                    `ì˜¤ë¥˜: ${error.message}\n\n` +
                    `API URL: ${apiUrl}/face-auth`, 
                    'error'
                );
            });
        }
        
        // íšŒì› ì •ë³´ í‘œì‹œ
        function displayMemberInfo(member) {
            const memberInfoDiv = document.getElementById('memberInfo');
            const memberDetailsDiv = document.getElementById('memberDetails');
            
            memberDetailsDiv.innerHTML = `
                <p><strong>íšŒì›ë²ˆí˜¸:</strong> ${member.mem_sno}</p>
                <p><strong>íšŒì›ëª…:</strong> ${member.mem_nm}</p>
                <p><strong>ì „í™”ë²ˆí˜¸:</strong> ${member.mem_telno_mask}</p>
            `;
            
            memberInfoDiv.style.display = 'block';
        }
        
        // ì´ìš©ê¶Œ ëª©ë¡ í‘œì‹œ
        function displayTickets(tickets) {
            const ticketList = document.getElementById('ticketList');
            ticketList.innerHTML = '<h3>ğŸ« ì´ìš© ê°€ëŠ¥í•œ ì´ìš©ê¶Œ:</h3>';
            
            tickets.forEach((ticket, index) => {
                const ticketDiv = document.createElement('div');
                ticketDiv.className = 'ticket-item';
                
                if (!ticket.is_available) {
                    ticketDiv.className += ' disabled';
                }
                
                let ticketIcon = ticket.ticket_type === 'count' ? 'ğŸ”¢' : 'ğŸ“…';
                let statusIcon = ticket.is_available ? 'âœ…' : 'âŒ';
                
                ticketDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${ticketIcon} ${ticket.ticket_name}</strong><br>
                            ${ticket.remaining_info} | ë§Œë£Œì¼: ${ticket.expire_date}<br>
                            <small>ID: ${ticket.ticket_id}</small>
                        </div>
                        <div style="text-align: right;">
                            ${statusIcon} ${ticket.is_available ? 'ì…ì¥ ê°€ëŠ¥' : 'ì…ì¥ ë¶ˆê°€'}
                        </div>
                    </div>
                `;
                
                if (ticket.is_available) {
                    ticketDiv.onclick = () => selectTicket(ticket, ticketDiv);
                }
                
                ticketList.appendChild(ticketDiv);
            });
            
            document.getElementById('checkinBtn').disabled = false;
        }
        
        // ì´ìš©ê¶Œ ì„ íƒ
        function selectTicket(ticket, element) {
            // ê¸°ì¡´ ì„ íƒ í•´ì œ
            document.querySelectorAll('.ticket-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // ìƒˆë¡œìš´ ì„ íƒ
            element.classList.add('selected');
            selectedTicket = ticket;
        }
        
        // ì²´í¬ì¸ ì²˜ë¦¬
        function processCheckin() {
            if (!selectedMember || !selectedTicket) {
                showResult('checkinResult', 'âš ï¸ íšŒì› ì •ë³´ì™€ ì´ìš©ê¶Œì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            const apiUrl = document.getElementById('apiUrl').value;
            const apiKey = document.getElementById('apiKey').value;
            
            const requestData = {
                mem_sno: selectedMember.mem_sno,
                ticket_id: selectedTicket.ticket_id,
                device_id: document.getElementById('deviceId').value,
                location: document.getElementById('location').value,
                language: document.getElementById('language').value
            };
            
            showResult('checkinResult', 'ğŸ”„ ì²´í¬ì¸ ì²˜ë¦¬ ì¤‘...', 'warning');
            
            fetch(apiUrl + '/checkin', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-API-Key': apiKey
                },
                body: JSON.stringify(requestData)
            })
            .then(response => response.json())
            .then(data => {
                console.log('Checkin Response:', data);
                
                if (data.success) {
                    showResult('checkinResult', 
                        `âœ… ì²´í¬ì¸ ì„±ê³µ!\n\n` +
                        JSON.stringify(data, null, 2), 
                        'success'
                    );
                    
                    // ì´ˆê¸°í™”
                    selectedTicket = null;
                    document.querySelectorAll('.ticket-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                } else {
                    showResult('checkinResult', 
                        `âŒ ì²´í¬ì¸ ì‹¤íŒ¨\n\n` +
                        JSON.stringify(data, null, 2), 
                        'error'
                    );
                }
            })
            .catch(error => {
                showResult('checkinResult', 
                    `âŒ API í˜¸ì¶œ ì‹¤íŒ¨\n\n` +
                    `ì˜¤ë¥˜: ${error.message}`, 
                    'error'
                );
            });
        }
        
        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('imagePreview');
                    img.src = e.target.result;
                    img.style.display = 'block';
                    
                    // Base64 ë°ì´í„° ì €ì¥
                    uploadedImageBase64 = e.target.result.split(',')[1];
                    document.getElementById('testImageBtn').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }
        
        // ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ë¡œ í…ŒìŠ¤íŠ¸
        function testWithUploadedImage() {
            if (uploadedImageBase64) {
                performFaceAuth(uploadedImageBase64);
            }
        }
        
        // ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        function testNoFace() {
            const apiUrl = document.getElementById('apiUrl').value;
            const requestData = {
                image: "R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==", // 1x1 íˆ¬ëª… ì´ë¯¸ì§€
                device_id: "KIOSK_TEST",
                language: document.getElementById('language').value
            };
            
            callAPI('/face-auth', requestData, 'scenarioResult');
        }
        
        function testSecurityFail() {
            showResult('scenarioResult', 
                'âš ï¸ ë³´ì•ˆ ê²€ì¦ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ì‹¤ì œ í™”ë©´/ì‚¬ì§„ ì´ë¯¸ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.\n' +
                'ì»´í“¨í„° í™”ë©´ì„ ì´¬ì˜í•œ ì´ë¯¸ì§€ë‚˜ ì¸ì‡„ëœ ì‚¬ì§„ì„ ì‚¬ìš©í•´ë³´ì„¸ìš”.', 
                'warning'
            );
        }
        
        function testMemberNotFound() {
            showResult('scenarioResult', 
                'âš ï¸ íšŒì› ë¯¸ë°œê²¬ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë“±ë¡ë˜ì§€ ì•Šì€ ì–¼êµ´ ì´ë¯¸ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.\n' +
                'ì‹œìŠ¤í…œì— ë“±ë¡ë˜ì§€ ì•Šì€ ì‚¬ëŒì˜ ì–¼êµ´ì„ ì´¬ì˜í•´ë³´ì„¸ìš”.', 
                'warning'
            );
        }
        
        function testNoTickets() {
            showResult('scenarioResult', 
                'âš ï¸ ì´ìš©ê¶Œ ì—†ìŒ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ì´ìš©ê¶Œì´ ì—†ëŠ” íšŒì›ì˜ ì–¼êµ´ ì´ë¯¸ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.\n' +
                'ì´ìš©ê¶Œì´ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ì—†ëŠ” íšŒì›ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”.', 
                'warning'
            );
        }
        
        // API í˜¸ì¶œ í—¬í¼ í•¨ìˆ˜
        function callAPI(endpoint, data, resultId) {
            const apiUrl = document.getElementById('apiUrl').value;
            const apiKey = document.getElementById('apiKey').value;
            
            fetch(apiUrl + endpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-API-Key': apiKey
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                const emoji = data.success ? 'âœ…' : getErrorEmoji(data.error_code);
                showResult(resultId, 
                    `${emoji} ì‘ë‹µ:\n\n` +
                    JSON.stringify(data, null, 2), 
                    data.success ? 'success' : 'error'
                );
            })
            .catch(error => {
                showResult(resultId, 'âŒ API í˜¸ì¶œ ì‹¤íŒ¨: ' + error.message, 'error');
            });
        }
        
        // ì—ëŸ¬ ì½”ë“œë³„ ì´ëª¨ì§€
        function getErrorEmoji(errorCode) {
            const emojiMap = {
                'E001': 'ğŸ“', // í•„ìˆ˜ íŒŒë¼ë¯¸í„° ëˆ„ë½
                'E002': 'ğŸ–¼ï¸', // ì˜ëª»ëœ ì´ë¯¸ì§€
                'E003': 'ğŸ˜¶', // ì–¼êµ´ ë¯¸ê²€ì¶œ
                'E004': 'ğŸš«', // ë³´ì•ˆ ê²€ì¦ ì‹¤íŒ¨
                'E005': 'â“', // íšŒì› ë¯¸ë°œê²¬
                'E006': 'ğŸ«', // ì´ìš©ê¶Œ ì—†ìŒ
                'E007': 'âŒ', // ì²´í¬ì¸ ì‹¤íŒ¨
                'E999': 'ğŸ’¥'  // ì„œë²„ ì˜¤ë¥˜
            };
            return emojiMap[errorCode] || 'âŒ';
        }
        
        // ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
        function showResult(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = 'result ' + type;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ API ìƒíƒœ í™•ì¸
        window.onload = function() {
            checkAPIStatus();
        };
    </script>
</body>
</html>