<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Markdown to HTML Converter</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .controls {
            position: fixed;
            top: 10px;
            right: 10px;
            background: white;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 5px;
        }
        button:hover {
            background: #0056b3;
        }
        h1 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; }
        h3 { color: #7f8c8d; }
        code {
            background: #f4f4f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        pre {
            background: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
        }
        blockquote {
            border-left: 4px solid #3498db;
            margin: 0;
            padding-left: 20px;
            color: #666;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        @media print {
            .controls { display: none; }
            body { margin: 0; padding: 20px; }
        }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="loadPaymentDoc()">결제 문서 로드</button>
        <button onclick="loadRefundDoc()">환불 문서 로드</button>
        <button onclick="window.print()">🖨️ 인쇄</button>
    </div>
    
    <div id="content">
        <h1>문서를 선택하세요</h1>
        <p>상단의 버튼을 클릭하여 문서를 로드하세요.</p>
    </div>

    <script>
        // Mermaid 초기화
        mermaid.initialize({ startOnLoad: true });

        // Marked 설정
        marked.setOptions({
            breaks: true,
            gfm: true
        });

        // Mermaid 코드 블록을 처리하는 렌더러
        const renderer = new marked.Renderer();
        const originalCodeRenderer = renderer.code;
        
        renderer.code = function(code, language) {
            if (language === 'mermaid') {
                return '<div class="mermaid">' + code + '</div>';
            }
            return originalCodeRenderer.call(this, code, language);
        };

        marked.use({ renderer });

        function renderMarkdown(markdown) {
            const html = marked.parse(markdown);
            document.getElementById('content').innerHTML = html;
            // Mermaid 다이어그램 렌더링
            mermaid.init();
        }

        function loadPaymentDoc() {
            const paymentDoc = `# SpoqPlus 결제 시스템 상세 문서

## 목차
1. [시스템 개요](#시스템-개요)
2. [결제 프로세스 플로우차트](#결제-프로세스-플로우차트)
3. [주요 컴포넌트](#주요-컴포넌트)

## 시스템 개요

SpoqPlus 결제 시스템은 피트니스/스포츠 센터에 특화된 종합 관리 시스템으로 다양한 상품 유형을 지원합니다.

## 결제 프로세스 플로우차트

\`\`\`mermaid
flowchart TD
    A[info_mem 페이지] --> B{구매하기 버튼 클릭}
    B --> C[JavaScript: info_mem_buy_event]
    C --> D[Redirect: /teventmain/event_buy2/mem_sno]
    
    D --> E[event_buy2 Controller]
    E --> F[회원 정보 조회]
    E --> G[이용중 상품 조회]
    E --> H[구매 가능 상품 표시]
    
    H --> I{상품 선택}
    I --> J[Redirect: /teventmain/event_buy_info]
    
    J --> K[event_buy_info Controller]
    K --> L[결제 정보 입력 폼]
    L --> M[결제 방법 선택]
    L --> N[희망 시작일 선택]
    L --> O[라커 선택<선택사항>]
    
    M --> P{결제하기 버튼}
    P --> Q[POST: /teventmain/event_buy_proc]
    
    Q --> R[event_buy_proc Controller]
    R --> S[Pay_lib 초기화]
    S --> T[buy_run 실행]
    
    T --> U[사전 검증]
    U --> V{상품 유형 확인}
    
    V -->|PT| W[func_pt_yes]
    V -->|이용권| X[func_pt_no]
    V -->|라커포함| Y[func_pt_no_lockr]
    V -->|라커미정| Z[func_pt_no_lockr_empty]
    
    W --> AA[후속 처리]
    X --> AA
    Y --> AA
    Z --> AA
    
    AA --> AB[기존 상품 재배열]
    AB --> AC[계좌입금 처리]
    AC --> AD[미수금 처리]
    AD --> AE[구매내역 저장]
    AE --> AF[결제관리 저장]
    AF --> AG[매출관리 저장]
    
    AG --> AH[완료 메시지]
    AH --> AI[Redirect: info_mem 페이지]
\`\`\`

## 주요 컴포넌트

### Controllers
- **Teventmain.php**: 결제 처리 메인 컨트롤러
- **event_buy2()**: 상품 선택
- **event_buy_info()**: 결제 정보 입력
- **event_buy_proc()**: 결제 처리

### Libraries
- **Pay_lib.php**: 결제 처리 핵심 라이브러리

### Models
- **PayModel.php**: 결제 데이터 관리
- **EventModel.php**: 상품 데이터 관리
- **MemModel.php**: 회원 데이터 관리`;

            renderMarkdown(paymentDoc);
        }

        function loadRefundDoc() {
            const refundDoc = `# SpoqPlus 환불 시스템 상세 문서

## 목차
1. [시스템 개요](#시스템-개요)
2. [환불 프로세스 플로우차트](#환불-프로세스-플로우차트)
3. [주요 컴포넌트](#주요-컴포넌트)

## 시스템 개요

SpoqPlus 환불 시스템은 회원이 구매한 상품을 환불 처리하는 종합 시스템입니다.

## 환불 프로세스 플로우차트

\`\`\`mermaid
flowchart TD
    A[info_mem 페이지] --> B[판매 리스트의 서브메뉴]
    B --> C{환불하기 버튼 클릭}
    C --> D[JavaScript: change_event_refund]
    D --> E[Redirect: /ttotalmain/refund_info/mem_sno/buy_sno]
    
    E --> F[refund_info Controller]
    F --> G[Refund_lib 초기화]
    G --> H[refund_info 메소드 실행]
    H --> I[환불 가능 금액 계산]
    
    I --> J[환불 정보 페이지 표시]
    J --> K[결제 내역 목록]
    J --> L[환불 금액 정보]
    J --> M[위약금/기타 비용 입력]
    
    K --> N{개별 환불 버튼 클릭}
    N --> O[JavaScript: refund_cancel]
    O --> P[AJAX: /teventmain/ajax_event_buy_van_direct_cancel_proc]
    
    P --> Q[VAN 직접 취소 처리]
    Q --> R[van_direct_hist 테이블 기록]
    R --> S[환불 금액 업데이트]
    
    M --> T{환불하기 버튼 클릭}
    T --> U[POST: /teventmain/refund_proc]
    
    U --> V[refund_proc Controller]
    V --> W[Refund_lib 초기화]
    W --> X[refund_run 실행]
\`\`\`

## 주요 컴포넌트

### Controllers
- **Ttotalmain.php**: 환불 정보 표시
- **Teventmain.php**: 환불 처리 실행

### Libraries
- **Refund_lib.php**: 환불 처리 핵심 라이브러리

### Models
- **PayModel.php**: 환불 데이터 저장
- **EventModel.php**: 상품 상태 업데이트`;

            renderMarkdown(refundDoc);
        }
    </script>
</body>
</html>